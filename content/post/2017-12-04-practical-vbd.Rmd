---
title: 'Vector Borne diseases: building a simple model'
author: "Zulma Cucunuba, Pierre Nouvellet"
date: '2017-12-04T14:00:00-00:00'
image: img/highres/siv-vbd.jpg
tags: Rmarkdown
categories: practicals
---

```{r options, include = FALSE, message = FALSE, warning = FALSE, error = FALSE}
library(knitr)

opts_chunk$set(collapse = TRUE)


```


This practical aims to illustrate the basics of **vector borne disease modelling**
using R, with an emphasis on how the methods work. We will use a basic model for an arboviral infection as an example. In this practical we will begin by gaining some understanding of the components which contribute to R0 and how potential interventions influence transmission. Later in the practical you will construct a model of Zika transmission to look at the effects of seasonal variation, change on basica parameters and estimating R0.



# Introduction

## Vector borne diseases transmission models


## Required packages


```{r eval=FALSE}
#install.packages("deSolve", dep=TRUE)
```

Then load the packages using:
```{r}
library(deSolve)
library(ggplot2)

```

## The model

In this section, please make a diagram of the vector transmission model that includes
- Sh : Susceptible Humans
- Ih : Ingected/Infectious humans
- Rh : humans recovered from infection (with lifelasting immunity)
- Sv : Susceptible vectors
- Iv : Infected vectors



## The parameters

Please fill in the parameters for complityng the model





## The model



```{r}


### Model for arboviral infection

model <- function (t, x, params) {
  
  Sh <- x[1]    #Susceptible humans
  Ih <- x[2]    #Infected humans
  Rh <- x[3]    #Recovered humans
  Sv <- x[4]    #Susceptible vectors
  Iv <- x[5]    #Infected vectors
  
   with(as.list(params), #local environment to evaluate derivatives

{
  # Humans
  
  dSh  <-  muh * Nh - (betah * b/Nh) * Sh * Iv - muh* Sh     # (eqn 1)
  dIh  <-  (betah * b/Nh) * Sh * Iv  - (gammah + muh)* Ih
  dRh   <-  gammah * Ih  - muh * Rh
  
  # Vectors
  dSv  <-   V - (betah * b/Nh) * Ih * Sv - muv * Sv 
  dIv  <-   (betah * b/Nh) * Ih * Sv - muv* Iv
  
  dx   <- c(dSh,dIh,dRh, dSv,dIv)
  list(dx)
}
)
}





```



```{r}
times  <- seq(1,365*5,by=10)

params <- c(
  muh      = 50 ^-1,
  V        = 5000,
  muv      = 50 ^-1,
  b        = 0.3,
  betah    = 0.1,
  betah    = 0.5,
  gammah   = 20 ^-1,
  Nh       = 10000
  
)

xstart<- c(Sh=1,Ih=1,Rh =1, Iv=1,Sv=1)

out <- as.data.frame(ode(xstart,times,model,params))


```






## Estimating R0



```{r fig.width = 8}
# Basic Reproduction Number (Homogeneous mixing)
# HomoRo = m*(a^2)*b*c*exp(-muv*deltaT)/(muv*r)
# HomoR0 = m*(a^2)*b*c*exp(-muv*deltaT)* Dh*Lv


```



## Plotting results



```{r molecular-clock}
par(mfrow = c(1,1))
par(mar=c(5,4,4,8),xpd=TRUE)
plot(out$time, (out$Rh + out$Ih + out$Sh), main="Humans",col="gray",
     cex=.7,ylab="Number of humans",xlab="Time (days)", type="o", pch = 19)
lines(out$time, out$Ih, main="Humans",col="red", type="o", pch = 19)
lines(out$time, out$Rh, main="Humans",col="darkgreen", type="o", pch = 19)
lines(out$time, out$Sh, main="Humans",col="blue", type="o", pch = 19)
legend("topright", c ("Sh","Ih", "Rh", 'total'), pch = 19, col = c("blue", "red", "darkgreen", "gray"),
       inset=c(-0.2,0))


# Vectors
par(mfrow = c(1,1))
par(mar=c(5,4,4,8),xpd=TRUE)
plot(out$time, (out$Iv + out$Sv), main="Vectors",col="gray",
     cex=.7,ylab="Number of vectors",xlab="Time (days)", type="o", pch = 19)
lines(out$time, out$Iv, col="red", type="o", pch = 19)
lines(out$time, out$Sv, col="blue", type="o", pch = 19)
legend("topright", c ("Sv","Iv", 'total'), pch = 19, col = c("blue", "red", "gray"),
       inset=c(-0.2,0))


```




     

# About this document

## Contributors

- Zulma Cucunuba: initial version

Contributions are welcome via [pull requests](https://github.com/reconhub/learn/pulls). The source file if this document can be found [**here**](https://raw.githubusercontent.com/reconhub/learn/master/content/post/2017-12-04-practical-vbd.Rmd).



## Legal stuff

**License**: [CC-BY](https://creativecommons.org/licenses/by/3.0/)
**Copyright**: Zulma Cucunuba & Pierre Nouvellet, 2017



# References

